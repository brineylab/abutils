<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="models" href="alignment_models.html" /><link rel="prev" title="pair" href="pair.html" />

    <!-- Generated with Sphinx 7.1.1 and Furo 2023.07.26 -->
        <title>lineage - abutils 0.1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b76e3c8a" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=135e06be" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=36a5483c" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">abutils 0.1.0 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky">
      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="lineage">
<h1>lineage<a class="headerlink" href="#lineage" title="Permalink to this heading">#</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="abutils.core.lineage.Lineage">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">abutils.core.lineage.</span></span><span class="sig-name descname"><span class="pre">Lineage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pairs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#abutils.core.lineage.Lineage" title="Permalink to this definition">#</a></dt>
<dd><p class="linemarker linemarker-1">Methods for manipulating an antibody lineage.</p>
<section id="inputs">
<h2>INPUTS<a class="headerlink" href="#inputs" title="Permalink to this heading">#</a></h2>
<p class="linemarker linemarker-6">pairs: a list of one or more vaxtools.utils.pair.Pair objects</p>
</section>
<section id="properties">
<h2>PROPERTIES<a class="headerlink" href="#properties" title="Permalink to this heading">#</a></h2>
<dl class="simple">
<dt>name: the Clonify ID of the lineage (if Clonify was used to assign lineages).</dt><dd><p class="linemarker linemarker-12">if [‘clonify’][‘id’] does not exist in any of the heavy chains, name will
be None.</p>
</dd>
<dt>just_pairs: a list containing all lineage Pair objects that have both heavy</dt><dd><p class="linemarker linemarker-16">and light chains.</p>
</dd>
<dt>verified_pairs: a list containing all lineage Pair objects that contain a</dt><dd><p class="linemarker linemarker-19">verified heavy/light pair.</p>
</dd>
<dt>heavies: a list of all lineage Pair objects with a heavy chain (whether or not</dt><dd><p class="linemarker linemarker-22">they also have a light chain)</p>
</dd>
<dt>lights: a list of all lineage Pair objects with a light chain (whether or not</dt><dd><p class="linemarker linemarker-25">they also have a heavy chain)</p>
</dd>
<dt>uca: returns a Pair objecct of the unmutated common ancestor for the lineage.</dt><dd><p class="linemarker linemarker-28">The uca is computed by taking the germline V(D)J regions, plus the N-addition
region(s) from the least mutated heavy or light chain. If the lineage contains
both heavy and light chains, the returned Pair will have ucas for both chains.</p>
</dd>
<dt>subject: if any of the Pair objects contains a ‘subject’ property, this will be returned.</dt><dd><p class="linemarker linemarker-33">If all ‘subject’ properties are the same, the return value will be a string. If there are
multiple different ‘subject’ properties, the return value will be a list. If no Pairs
have a ‘subject’ property, None will be returned.</p>
</dd>
<dt>experiment: if any of the Pair objects contains a ‘experiment’ property, this will be returned.</dt><dd><p class="linemarker linemarker-38">If all ‘experiment’ properties are the same, the return value will be a string. If there are
multiple different ‘experiment’ properties, the return value will be a list. If no Pairs
have a ‘experiment’ property, None will be returned.</p>
</dd>
<dt>group: if any of the Pair objects contains a ‘group’ property, this will be returned.</dt><dd><p class="linemarker linemarker-43">If all ‘group’ properties are the same, the return value will be a string. If there are
multiple different ‘group’ properties, the return value will be a list. If no Pairs
have a ‘group’ property, None will be returned.</p>
</dd>
<dt>timepoint: if any of the Pair objects contains a ‘timepoint’ property, this will be returned.</dt><dd><p class="linemarker linemarker-48">If all ‘timepoint’ properties are the same, the return value will be a string. If there are
multiple different ‘timepoint’ properties, the return value will be a list. If no Pairs
have a ‘timepoint’ property, None will be returned.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="abutils.core.lineage.Lineage.phylogeny">
<span class="sig-name descname"><span class="pre">phylogeny</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#abutils.core.lineage.Lineage.phylogeny" title="Permalink to this definition">#</a></dt>
<dd><section id="id1">
<h3>Inputs<a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h3>
<p class="linemarker linemarker-58">project_dir: directory for alignment, tree and figure files (required)</p>
<dl class="simple">
<dt>aln_file: if an alignment file has already been computed, passing the file path</dt><dd><p class="linemarker linemarker-61">will force phylogeny() to use this alignment instead of computing a new one.</p>
</dd>
<dt>tree_file: if a tree file has already been computed, passing the file path</dt><dd><p class="linemarker linemarker-64">will force phylogeny() to use this tree instead of computing a new one.</p>
</dd>
</dl>
<p class="linemarker linemarker-66">aa: if True, build an alignment based on amino acid sequences. Default is False.</p>
<p class="linemarker linemarker-68">root: provide a sequence (string) to root the tree. Default is to use the UCA.</p>
<dl class="simple">
<dt>colors: a dict that maps sequences to colors (as hex values). If used without</dt><dd><p class="linemarker linemarker-71">orders or order_function, keys should be Pair names and values should be hex
strings for all Pairs to be colored. Any Pair not present in the dict will
be colored black. If used with orders or order_function, the keys should be
orders and the values should be hex strings. As before, any order values
not present in the dict will be colored black.</p>
</dd>
</dl>
</section>
</dd></dl>

</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="abutils.core.lineage.group_lineages">
<span class="sig-prename descclassname"><span class="pre">abutils.core.lineage.</span></span><span class="sig-name descname"><span class="pre">group_lineages</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pairs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">just_pairs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#abutils.core.lineage.group_lineages" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="abutils.core.lineage.donut">
<span class="sig-prename descclassname"><span class="pre">abutils.core.lineage.</span></span><span class="sig-name descname"><span class="pre">donut</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lineages</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(6,</span> <span class="pre">6)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pairs_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">monochrome_color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">singleton_color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'lightgrey'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle_colors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1234</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">text_kws</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pie_kws</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">28</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linewidth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#abutils.core.lineage.donut" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="alignment_models.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">models</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="pair.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">pair</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2018, Bryan Briney
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">lineage</a><ul>
<li><a class="reference internal" href="#abutils.core.lineage.Lineage"><code class="docutils literal notranslate"><span class="pre">Lineage</span></code></a><ul>
<li><a class="reference internal" href="#abutils.core.lineage.Lineage.phylogeny"><code class="docutils literal notranslate"><span class="pre">Lineage.phylogeny()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#abutils.core.lineage.group_lineages"><code class="docutils literal notranslate"><span class="pre">group_lineages()</span></code></a></li>
<li><a class="reference internal" href="#abutils.core.lineage.donut"><code class="docutils literal notranslate"><span class="pre">donut()</span></code></a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=2389946f"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="../_static/scripts/furo.js?v=32e29ea5"></script>
    </body>
</html>